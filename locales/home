#!/usr/bin/env zsh

# ---------------------------------------------------------------------------- 
# ENVS
#
# Environment variables to set for zsh session
# ---------------------------------------------------------------------------- 
export _BASE_ARCHIVES="${XDG_CACHE_HOME}/archives"


# ----------------------------------------------------------------------------
# PATHS
#
# Specify paths for user environment
# ----------------------------------------------------------------------------
_in_env ${XDG_BIN_HOME} ${PATH} || _prependenv PATH "${XDG_BIN_HOME}"


# ----------------------------------------------------------------------------
# CONDA PATHS 
#
# Take control over go environment by specifying conda paths
# ----------------------------------------------------------------------------
export CONDARC="${XDG_CONFIG_HOME}/.condarc"

# ----------------------------------------------------------------------------
# GO PATHS 
#
# Take control over go environment by specifying GO paths
# ----------------------------------------------------------------------------
export GOROOT="${_BASE_OPT}/go/current"
export GOPATH="${_BASE_OPT}/go/package"
export GOBIN="${GOPATH}/bin"
export GHQ_ROOT="${_BASE_HOME}/dev"


# ---------------------------------------------------------------------------- 
# PIPSI
#
# Is used to provide python executables that we want to launch with specific
# python versions, it's great as you don'thave to bother managing environments
# for executables you use in your everyday life.
# ---------------------------------------------------------------------------- 
export PIPSI_HOME="${_BASE_OPT}/pipsi"
export PIPSI_BIN_DIR="$(readlink -f ${PIPSI_HOME}/bin)"
if [ -d "${PIPSI_BIN_DIR}" ]; then
  _in_env ${PIPSI_BIN_DIR} ${PATH} || _prependenv PATH "${PIPSI_BIN_DIR}"
fi


# XXX: 
# All static packages should symmlink to the XDG bin folder, all dynamic
# (locations that will add to bin directory) should have sepparete locations
# ----------------------------------------------------------------------------
paths=(
  kitty/bin
  redpen/bin 
  texlive/2018/bin/x86_64-linux 
)

for p in ${paths[@]}; do
  add=$(readlink -f "${_BASE_OPT}/${p}")
  # Don't Do anything if the diectory doesn't exist
  if [ -d "${add}" ]; then
    # If already in PATH ignore
    _in_env ${add} ${PATH} || _prependenv PATH "${add}"
  fi
done


# ---------------------------------------------------------------------------- 
# evals
#
# Export PATH and other variables that needs to be set
# ---------------------------------------------------------------------------- 
if (command -v direnv &> /dev/null );then
  eval "$(direnv hook zsh)"
fi

source "/scratch/opt/conda/etc/profile.d/conda.sh"

# ---------------------------------------------------------------------------- 
# FINALIZE
#
# Export PATH and other variables that needs to be set
# ---------------------------------------------------------------------------- 
export PATH
